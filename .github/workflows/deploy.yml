name: Build Frontend
on:
  push:
    branches: [ "kien" ]

jobs:
  build:
    runs-on: ubuntu-latest
    env:
      WORKING_DIR: frontend  

    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0  
          - name: Debug before install
          working-directory: frontend
          run: |
            echo "Node version: $(node -v)"
            echo "NPM version: $(npm -v)"
            echo "Checking package.json:"
            cat package.json
            echo "Files in directory:"
            ls -la
      
        - name: Install dependencies
          working-directory: frontend
          run: |
            npm ci --verbose  # Thêm --verbose để xem chi tiết lỗi
            echo "Install completed with status $?"
      
        - name: Build project
          working-directory: frontend
          run: |
            npm run build --verbose
            echo "Build completed with status $?"
          continue-on-error: true  
      
        - name: Upload logs if failed
          if: failure()
          uses: actions/upload-artifact@v4
          with:
            name: error-logs
            path: |
              frontend/npm-debug.log
              frontend/yarn-error.log